
api:
  key: ${BINANCE_API_KEY}
  secret: ${BINANCE_API_SECRET}

pairs:
  - symbol: ZECUSDT
    quote: USDT
    b_alloc: 23456.0
    source: binance
    interval: 1m
    lookback_days: 2
    fees: { taker: 0.001, maker: 0.001 }

    # บันไดสะสมหลัก (Martingale)
    # - d_buy: ระยะห่างแต่ละขั้น (เริ่ม 3%)
    # - m_buy: ตัวคูณขนาดไม้เมื่อถอยลง
    # - n_steps: จำนวนขั้นสูงสุดในรอบสะสมหลัก
    buy_ladder:
      d_buy: 0.02
      m_buy: 1.5
      n_steps: 10
      spacing_mode: fibo
      size_mode: fibonacci
      gap_mode: multiplicative
      gap_factor: 1.05
      max_step_drop: 0.3
      base_order_quote: 0.0
      max_quote_per_leg: 0.0
      max_total_quote: 0.0

    profit_trail:
      p_min: 0.025
      s1: 0.01
      m_step: 1.6
      tau: 0.7
      p_lock_base: 0.007
      p_lock_max: 0.03
      tau_min: 0.3
      no_loss_epsilon: 0.0018

    time_martingale:
      W1_minutes: 5
      m_time: 2.0
      delta_lock: 0.002
      beta_tau: 0.9

    time_caps:
      T_idle_max_minutes: 70
      p_idle: 0.008
      T_total_cap_minutes: 180
      p_exit_min: 0.008

    features:
      scalp_mode:
        enabled: true
        # scalp_mode = เข้าเร็ว–ออกเร็ว แยกจากบันไดหลัก
        # max_trades = จำนวนไม้ scalp ต่อรอบ (ตั้ง 10 เพื่อเกิน 3 ไม้เดิม)
        max_trades: 10
        base_drop_pct: 0.03
        min_drop_pct: 0.015
        max_drop_pct: 0.06
        base_take_profit_pct: 0.01
        min_take_profit_pct: 0.008
        max_take_profit_pct: 0.02
        volatility_ref_pct: 0.04
        scale_strength: 0.6
        order_pct_allocation: 0.33
        cooldown_bars: 3
      micro_oscillation:
        enabled: true
        window: 45
        max_band_pct: 0.012
        min_swings: 5
        min_swing_pct: 0.0012
        entry_band_pct: 0.18
        take_profit_pct: 0.003
        stop_break_pct: 0.0035
        # Minimum margin above break-even (after fees) for micro exits
        min_profit_pct: 0.0025
        volatility_stop_mult: 1.0
        volatility_take_profit_mult: 0.7
        volatility_reentry_mult: 0.9
        order_pct_allocation: 0.12
        cooldown_bars: 8
        min_exit_qty: 0.0
      buy_the_dip:
        # เปิดซื้อดักหลุดบันได (dip) แยกจาก n_steps หลัก
        enabled: true
        dip_threshold: 0.05
        rebound_min: 0.004
        rebound_max: 0.02
        cooldown_minutes: 10
        max_orders: 7
        rebase_ladder_from_dip: true
        rebase_offset: 0.0
        order_quote: 0.0
        order_pct_remaining: 0.5
        limit_offset: 0.001
        cancel_on_miss: true
        isolate_from_ladder: true
      sell_at_height:
        # เปิดขายบนยอด (rip) เมื่อราคายืดเกิน threshold แล้วดึงกลับ
        enabled: true
        height_threshold: 0.04
        pullback_min: 0.004
        pullback_max: 0.02
        cooldown_minutes: 10
        order_pct_position: 0.5
        limit_offset: 0.001
        min_qty: 0.0
        cancel_on_miss: true
      adaptive_ladder:
        enabled: true
        bootstrap_d_buy: 0.03
        # จำกัดจำนวนขั้นช่วงสังเกตการณ์ก่อนคำนวณ d_buy ใหม่อัตโนมัติ
        bootstrap_steps: 3
        min_d_buy: 0.02
        max_d_buy: 0.08
        volatility_window: 120
        sensitivity: 0.6
        rebalance_threshold: 0.001
      anchor_drift:
        enabled: true
        structure_window: 40
        atr_period: 14
        breakout_atr_multiplier: 1.2
        stable_band_pct: 0.01
        dwell_bars: 15
        min_displacement_atr: 0.5
        min_displacement_pct: 0.005
        cooldown_bars: 20
    plotting: { enable: true }

  - symbol: DCRUSDT
    quote: USDT
    b_alloc: 12345.0
    source: binance
    interval: 1m
    lookback_days: 2
    fees: { taker: 0.001, maker: 0.001 }

    # บันไดสะสมหลัก (Martingale)
    # - d_buy: ระยะห่างแต่ละขั้น (เริ่ม 3%)
    # - m_buy: ตัวคูณขนาดไม้เมื่อถอยลง
    # - n_steps: จำนวนขั้นสูงสุดในรอบสะสมหลัก
    buy_ladder:
      d_buy: 0.02
      m_buy: 1.5
      n_steps: 10
      spacing_mode: fibo
      size_mode: fibonacci
      gap_mode: multiplicative
      gap_factor: 1.05
      max_step_drop: 0.3
      base_order_quote: 0.0
      max_quote_per_leg: 0.0
      max_total_quote: 0.0

    profit_trail:
      p_min: 0.025
      s1: 0.01
      m_step: 1.6
      tau: 0.7
      p_lock_base: 0.007
      p_lock_max: 0.03
      tau_min: 0.3
      no_loss_epsilon: 0.0018

    time_martingale:
      W1_minutes: 5
      m_time: 2.0
      delta_lock: 0.002
      beta_tau: 0.9

    time_caps:
      T_idle_max_minutes: 70
      p_idle: 0.008
      T_total_cap_minutes: 180
      p_exit_min: 0.008

    features:
      scalp_mode:
        enabled: true
        # scalp_mode = เข้าเร็ว–ออกเร็ว แยกจากบันไดหลัก
        # max_trades = จำนวนไม้ scalp ต่อรอบ (ตั้ง 10 เพื่อเกิน 3 ไม้เดิม)
        max_trades: 10
        base_drop_pct: 0.03
        min_drop_pct: 0.015
        max_drop_pct: 0.06
        base_take_profit_pct: 0.01
        min_take_profit_pct: 0.008
        max_take_profit_pct: 0.02
        volatility_ref_pct: 0.04
        scale_strength: 0.6
        order_pct_allocation: 0.33
        cooldown_bars: 3
      micro_oscillation:
        enabled: true
        window: 45
        max_band_pct: 0.012
        min_swings: 5
        min_swing_pct: 0.0012
        entry_band_pct: 0.18
        take_profit_pct: 0.003
        stop_break_pct: 0.0035
        # Minimum margin above break-even (after fees) for micro exits
        min_profit_pct: 0.0025
        volatility_stop_mult: 1.0
        volatility_take_profit_mult: 0.7
        volatility_reentry_mult: 0.9
        order_pct_allocation: 0.12
        cooldown_bars: 8
        min_exit_qty: 0.0
      buy_the_dip:
        # เปิดซื้อดักหลุดบันได (dip) แยกจาก n_steps หลัก
        enabled: true
        dip_threshold: 0.05
        rebound_min: 0.004
        rebound_max: 0.02
        cooldown_minutes: 10
        max_orders: 7
        rebase_ladder_from_dip: true
        rebase_offset: 0.0
        order_quote: 0.0
        order_pct_remaining: 0.5
        limit_offset: 0.001
        cancel_on_miss: true
        isolate_from_ladder: true
      sell_at_height:
        # เปิดขายบนยอด (rip) เมื่อราคายืดเกิน threshold แล้วดึงกลับ
        enabled: true
        height_threshold: 0.04
        pullback_min: 0.004
        pullback_max: 0.02
        cooldown_minutes: 10
        order_pct_position: 0.5
        limit_offset: 0.001
        min_qty: 0.0
        cancel_on_miss: true
      adaptive_ladder:
        enabled: true
        bootstrap_d_buy: 0.03
        # จำกัดจำนวนขั้นช่วงสังเกตการณ์ก่อนคำนวณ d_buy ใหม่อัตโนมัติ
        bootstrap_steps: 3
        min_d_buy: 0.02
        max_d_buy: 0.08
        volatility_window: 120
        sensitivity: 0.6
        rebalance_threshold: 0.001
      anchor_drift:
        enabled: true
        structure_window: 40
        atr_period: 14
        breakout_atr_multiplier: 1.2
        stable_band_pct: 0.01
        dwell_bars: 15
        min_displacement_atr: 0.5
        min_displacement_pct: 0.005
        cooldown_bars: 20
    plotting: { enable: true }

  - symbol: DGBUSDT
    quote: USDT
    b_alloc: 6666.0
    source: binance
    interval: 1m
    lookback_days: 2
    fees: { taker: 0.001, maker: 0.001 }

    # บันไดสะสมหลัก (Martingale)
    # - d_buy: ระยะห่างแต่ละขั้น (เริ่ม 3%)
    # - m_buy: ตัวคูณขนาดไม้เมื่อถอยลง
    # - n_steps: จำนวนขั้นสูงสุดในรอบสะสมหลัก
    buy_ladder:
      d_buy: 0.02
      m_buy: 1.5
      n_steps: 10
      spacing_mode: fibo
      size_mode: fibonacci
      gap_mode: multiplicative
      gap_factor: 1.05
      max_step_drop: 0.3
      base_order_quote: 0.0
      max_quote_per_leg: 0.0
      max_total_quote: 0.0

    profit_trail:
      p_min: 0.025
      s1: 0.01
      m_step: 1.6
      tau: 0.7
      p_lock_base: 0.007
      p_lock_max: 0.03
      tau_min: 0.3
      no_loss_epsilon: 0.0018

    time_martingale:
      W1_minutes: 5
      m_time: 2.0
      delta_lock: 0.002
      beta_tau: 0.9

    time_caps:
      T_idle_max_minutes: 70
      p_idle: 0.008
      T_total_cap_minutes: 180
      p_exit_min: 0.008

    features:
      scalp_mode:
        enabled: true
        # scalp_mode = เข้าเร็ว–ออกเร็ว แยกจากบันไดหลัก
        # max_trades = จำนวนไม้ scalp ต่อรอบ (ตั้ง 10 เพื่อเกิน 3 ไม้เดิม)
        max_trades: 10
        base_drop_pct: 0.03
        min_drop_pct: 0.015
        max_drop_pct: 0.06
        base_take_profit_pct: 0.01
        min_take_profit_pct: 0.008
        max_take_profit_pct: 0.02
        volatility_ref_pct: 0.04
        scale_strength: 0.6
        order_pct_allocation: 0.33
        cooldown_bars: 3
      micro_oscillation:
        enabled: true
        window: 45
        max_band_pct: 0.012
        min_swings: 5
        min_swing_pct: 0.0012
        entry_band_pct: 0.18
        take_profit_pct: 0.003
        stop_break_pct: 0.0035
        # Minimum margin above break-even (after fees) for micro exits
        min_profit_pct: 0.0025
        volatility_stop_mult: 1.0
        volatility_take_profit_mult: 0.7
        volatility_reentry_mult: 0.9
        order_pct_allocation: 0.12
        cooldown_bars: 8
        min_exit_qty: 0.0
      buy_the_dip:
        # เปิดซื้อดักหลุดบันได (dip) แยกจาก n_steps หลัก
        enabled: true
        dip_threshold: 0.05
        rebound_min: 0.004
        rebound_max: 0.02
        cooldown_minutes: 10
        max_orders: 7
        rebase_ladder_from_dip: true
        rebase_offset: 0.0
        order_quote: 0.0
        order_pct_remaining: 0.5
        limit_offset: 0.001
        cancel_on_miss: true
        isolate_from_ladder: true
      sell_at_height:
        # เปิดขายบนยอด (rip) เมื่อราคายืดเกิน threshold แล้วดึงกลับ
        enabled: true
        height_threshold: 0.04
        pullback_min: 0.004
        pullback_max: 0.02
        cooldown_minutes: 10
        order_pct_position: 0.5
        limit_offset: 0.001
        min_qty: 0.0
        cancel_on_miss: true
      adaptive_ladder:
        enabled: true
        bootstrap_d_buy: 0.03
        # จำกัดจำนวนขั้นช่วงสังเกตการณ์ก่อนคำนวณ d_buy ใหม่อัตโนมัติ
        bootstrap_steps: 3
        min_d_buy: 0.02
        max_d_buy: 0.08
        volatility_window: 120
        sensitivity: 0.6
        rebalance_threshold: 0.001
      anchor_drift:
        enabled: true
        structure_window: 40
        atr_period: 14
        breakout_atr_multiplier: 1.2
        stable_band_pct: 0.01
        dwell_bars: 15
        min_displacement_atr: 0.5
        min_displacement_pct: 0.005
        cooldown_bars: 20
    plotting: { enable: true }

  - symbol: BNBUSDT
    quote: USDT
    b_alloc: 5555.0
    source: binance
    interval: 1m
    lookback_days: 2
    fees: { taker: 0.001, maker: 0.001 }

    # บันไดสะสมหลัก (Martingale)
    # - d_buy: ระยะห่างแต่ละขั้น (เริ่ม 3%)
    # - m_buy: ตัวคูณขนาดไม้เมื่อถอยลง
    # - n_steps: จำนวนขั้นสูงสุดในรอบสะสมหลัก
    buy_ladder:
      d_buy: 0.02
      m_buy: 1.5
      n_steps: 10
      spacing_mode: fibo
      size_mode: fibonacci
      gap_mode: multiplicative
      gap_factor: 1.05
      max_step_drop: 0.3
      base_order_quote: 0.0
      max_quote_per_leg: 0.0
      max_total_quote: 0.0

    profit_trail:
      p_min: 0.025
      s1: 0.01
      m_step: 1.6
      tau: 0.7
      p_lock_base: 0.007
      p_lock_max: 0.03
      tau_min: 0.3
      no_loss_epsilon: 0.0018

    time_martingale:
      W1_minutes: 5
      m_time: 2.0
      delta_lock: 0.002
      beta_tau: 0.9

    time_caps:
      T_idle_max_minutes: 70
      p_idle: 0.008
      T_total_cap_minutes: 180
      p_exit_min: 0.008

    features:
      scalp_mode:
        enabled: true
        # scalp_mode = เข้าเร็ว–ออกเร็ว แยกจากบันไดหลัก
        # max_trades = จำนวนไม้ scalp ต่อรอบ (ตั้ง 10 เพื่อเกิน 3 ไม้เดิม)
        max_trades: 10
        base_drop_pct: 0.03
        min_drop_pct: 0.015
        max_drop_pct: 0.06
        base_take_profit_pct: 0.01
        min_take_profit_pct: 0.008
        max_take_profit_pct: 0.02
        volatility_ref_pct: 0.04
        scale_strength: 0.6
        order_pct_allocation: 0.33
        cooldown_bars: 3
      micro_oscillation:
        enabled: true
        window: 45
        max_band_pct: 0.012
        min_swings: 5
        min_swing_pct: 0.0012
        entry_band_pct: 0.18
        take_profit_pct: 0.003
        stop_break_pct: 0.0035
        # Minimum margin above break-even (after fees) for micro exits
        min_profit_pct: 0.0025
        volatility_stop_mult: 1.0
        volatility_take_profit_mult: 0.7
        volatility_reentry_mult: 0.9
        order_pct_allocation: 0.12
        cooldown_bars: 8
        min_exit_qty: 0.0
      buy_the_dip:
        # เปิดซื้อดักหลุดบันได (dip) แยกจาก n_steps หลัก
        enabled: true
        dip_threshold: 0.05
        rebound_min: 0.004
        rebound_max: 0.02
        cooldown_minutes: 10
        max_orders: 7
        rebase_ladder_from_dip: true
        rebase_offset: 0.0
        order_quote: 0.0
        order_pct_remaining: 0.5
        limit_offset: 0.001
        cancel_on_miss: true
        isolate_from_ladder: true
      sell_at_height:
        # เปิดขายบนยอด (rip) เมื่อราคายืดเกิน threshold แล้วดึงกลับ
        enabled: true
        height_threshold: 0.04
        pullback_min: 0.004
        pullback_max: 0.02
        cooldown_minutes: 10
        order_pct_position: 0.5
        limit_offset: 0.001
        min_qty: 0.0
        cancel_on_miss: true
      adaptive_ladder:
        enabled: true
        bootstrap_d_buy: 0.03
        # จำกัดจำนวนขั้นช่วงสังเกตการณ์ก่อนคำนวณ d_buy ใหม่อัตโนมัติ
        bootstrap_steps: 3
        min_d_buy: 0.02
        max_d_buy: 0.08
        volatility_window: 120
        sensitivity: 0.6
        rebalance_threshold: 0.001
      anchor_drift:
        enabled: true
        structure_window: 40
        atr_period: 14
        breakout_atr_multiplier: 1.2
        stable_band_pct: 0.01
        dwell_bars: 15
        min_displacement_atr: 0.5
        min_displacement_pct: 0.005
        cooldown_bars: 20
    plotting: { enable: true }

  - symbol: KITEUSDT
    quote: USDT
    b_alloc: 4567.0
    source: binance
    interval: 1m
    lookback_days: 2
    fees: { taker: 0.001, maker: 0.001 }

    # บันไดสะสมหลัก (Martingale)
    # - d_buy: ระยะห่างแต่ละขั้น (เริ่ม 3%)
    # - m_buy: ตัวคูณขนาดไม้เมื่อถอยลง
    # - n_steps: จำนวนขั้นสูงสุดในรอบสะสมหลัก
    buy_ladder:
      d_buy: 0.02
      m_buy: 1.5
      n_steps: 10
      spacing_mode: fibo
      size_mode: fibonacci
      gap_mode: multiplicative
      gap_factor: 1.05
      max_step_drop: 0.3
      base_order_quote: 0.0
      max_quote_per_leg: 0.0
      max_total_quote: 0.0

    profit_trail:
      p_min: 0.025
      s1: 0.01
      m_step: 1.6
      tau: 0.7
      p_lock_base: 0.007
      p_lock_max: 0.03
      tau_min: 0.3
      no_loss_epsilon: 0.0018

    time_martingale:
      W1_minutes: 5
      m_time: 2.0
      delta_lock: 0.002
      beta_tau: 0.9

    time_caps:
      T_idle_max_minutes: 70
      p_idle: 0.008
      T_total_cap_minutes: 180
      p_exit_min: 0.008

    features:
      scalp_mode:
        enabled: true
        # scalp_mode = เข้าเร็ว–ออกเร็ว แยกจากบันไดหลัก
        # max_trades = จำนวนไม้ scalp ต่อรอบ (ตั้ง 10 เพื่อเกิน 3 ไม้เดิม)
        max_trades: 10
        base_drop_pct: 0.03
        min_drop_pct: 0.015
        max_drop_pct: 0.06
        base_take_profit_pct: 0.01
        min_take_profit_pct: 0.008
        max_take_profit_pct: 0.02
        volatility_ref_pct: 0.04
        scale_strength: 0.6
        order_pct_allocation: 0.33
        cooldown_bars: 3
      micro_oscillation:
        enabled: true
        window: 45
        max_band_pct: 0.012
        min_swings: 5
        min_swing_pct: 0.0012
        entry_band_pct: 0.18
        take_profit_pct: 0.003
        stop_break_pct: 0.0035
        # Minimum margin above break-even (after fees) for micro exits
        min_profit_pct: 0.0025
        volatility_stop_mult: 1.0
        volatility_take_profit_mult: 0.7
        volatility_reentry_mult: 0.9
        order_pct_allocation: 0.12
        cooldown_bars: 8
        min_exit_qty: 0.0
      buy_the_dip:
        # เปิดซื้อดักหลุดบันได (dip) แยกจาก n_steps หลัก
        enabled: true
        dip_threshold: 0.05
        rebound_min: 0.004
        rebound_max: 0.02
        cooldown_minutes: 10
        max_orders: 7
        rebase_ladder_from_dip: true
        rebase_offset: 0.0
        order_quote: 0.0
        order_pct_remaining: 0.5
        limit_offset: 0.001
        cancel_on_miss: true
        isolate_from_ladder: true
      sell_at_height:
        # เปิดขายบนยอด (rip) เมื่อราคายืดเกิน threshold แล้วดึงกลับ
        enabled: true
        height_threshold: 0.04
        pullback_min: 0.004
        pullback_max: 0.02
        cooldown_minutes: 10
        order_pct_position: 0.5
        limit_offset: 0.001
        min_qty: 0.0
        cancel_on_miss: true
      adaptive_ladder:
        enabled: true
        bootstrap_d_buy: 0.03
        # จำกัดจำนวนขั้นช่วงสังเกตการณ์ก่อนคำนวณ d_buy ใหม่อัตโนมัติ
        bootstrap_steps: 3
        min_d_buy: 0.02
        max_d_buy: 0.08
        volatility_window: 120
        sensitivity: 0.6
        rebalance_threshold: 0.001
      anchor_drift:
        enabled: true
        structure_window: 40
        atr_period: 14
        breakout_atr_multiplier: 1.2
        stable_band_pct: 0.01
        dwell_bars: 15
        min_displacement_atr: 0.5
        min_displacement_pct: 0.005
        cooldown_bars: 20
    plotting: { enable: true }

  - symbol: TWTUSDT
    quote: USDT
    b_alloc: 4444.0
    source: binance
    interval: 1m
    lookback_days: 2
    fees: { taker: 0.001, maker: 0.001 }

    # บันไดสะสมหลัก (Martingale)
    # - d_buy: ระยะห่างแต่ละขั้น (เริ่ม 3%)
    # - m_buy: ตัวคูณขนาดไม้เมื่อถอยลง
    # - n_steps: จำนวนขั้นสูงสุดในรอบสะสมหลัก
    buy_ladder:
      d_buy: 0.02
      m_buy: 1.5
      n_steps: 10
      spacing_mode: fibo
      size_mode: fibonacci
      gap_mode: multiplicative
      gap_factor: 1.05
      max_step_drop: 0.3
      base_order_quote: 0.0
      max_quote_per_leg: 0.0
      max_total_quote: 0.0

    profit_trail:
      p_min: 0.025
      s1: 0.01
      m_step: 1.6
      tau: 0.7
      p_lock_base: 0.007
      p_lock_max: 0.03
      tau_min: 0.3
      no_loss_epsilon: 0.0018

    time_martingale:
      W1_minutes: 5
      m_time: 2.0
      delta_lock: 0.002
      beta_tau: 0.9

    time_caps:
      T_idle_max_minutes: 70
      p_idle: 0.008
      T_total_cap_minutes: 180
      p_exit_min: 0.008

    features:
      scalp_mode:
        enabled: true
        # scalp_mode = เข้าเร็ว–ออกเร็ว แยกจากบันไดหลัก
        # max_trades = จำนวนไม้ scalp ต่อรอบ (ตั้ง 10 เพื่อเกิน 3 ไม้เดิม)
        max_trades: 10
        base_drop_pct: 0.03
        min_drop_pct: 0.015
        max_drop_pct: 0.06
        base_take_profit_pct: 0.01
        min_take_profit_pct: 0.008
        max_take_profit_pct: 0.02
        volatility_ref_pct: 0.04
        scale_strength: 0.6
        order_pct_allocation: 0.33
        cooldown_bars: 3
      micro_oscillation:
        enabled: true
        window: 45
        max_band_pct: 0.012
        min_swings: 5
        min_swing_pct: 0.0012
        entry_band_pct: 0.18
        take_profit_pct: 0.003
        stop_break_pct: 0.0035
        # Minimum margin above break-even (after fees) for micro exits
        min_profit_pct: 0.0025
        volatility_stop_mult: 1.0
        volatility_take_profit_mult: 0.7
        volatility_reentry_mult: 0.9
        order_pct_allocation: 0.12
        cooldown_bars: 8
        min_exit_qty: 0.0
      buy_the_dip:
        # เปิดซื้อดักหลุดบันได (dip) แยกจาก n_steps หลัก
        enabled: true
        dip_threshold: 0.05
        rebound_min: 0.004
        rebound_max: 0.02
        cooldown_minutes: 10
        max_orders: 7
        rebase_ladder_from_dip: true
        rebase_offset: 0.0
        order_quote: 0.0
        order_pct_remaining: 0.5
        limit_offset: 0.001
        cancel_on_miss: true
        isolate_from_ladder: true
      sell_at_height:
        # เปิดขายบนยอด (rip) เมื่อราคายืดเกิน threshold แล้วดึงกลับ
        enabled: true
        height_threshold: 0.04
        pullback_min: 0.004
        pullback_max: 0.02
        cooldown_minutes: 10
        order_pct_position: 0.5
        limit_offset: 0.001
        min_qty: 0.0
        cancel_on_miss: true
      adaptive_ladder:
        enabled: true
        bootstrap_d_buy: 0.03
        # จำกัดจำนวนขั้นช่วงสังเกตการณ์ก่อนคำนวณ d_buy ใหม่อัตโนมัติ
        bootstrap_steps: 3
        min_d_buy: 0.02
        max_d_buy: 0.08
        volatility_window: 120
        sensitivity: 0.6
        rebalance_threshold: 0.001
      anchor_drift:
        enabled: true
        structure_window: 40
        atr_period: 14
        breakout_atr_multiplier: 1.2
        stable_band_pct: 0.01
        dwell_bars: 15
        min_displacement_atr: 0.5
        min_displacement_pct: 0.005
        cooldown_bars: 20
    plotting: { enable: true }

  - symbol: SFPUSDT
    quote: USDT
    b_alloc: 4567.0
    source: binance
    interval: 1m
    lookback_days: 2
    fees: { taker: 0.001, maker: 0.001 }

    # บันไดสะสมหลัก (Martingale)
    # - d_buy: ระยะห่างแต่ละขั้น (เริ่ม 3%)
    # - m_buy: ตัวคูณขนาดไม้เมื่อถอยลง
    # - n_steps: จำนวนขั้นสูงสุดในรอบสะสมหลัก
    buy_ladder:
      d_buy: 0.02
      m_buy: 1.5
      n_steps: 10
      spacing_mode: fibo
      size_mode: fibonacci
      gap_mode: multiplicative
      gap_factor: 1.05
      max_step_drop: 0.3
      base_order_quote: 0.0
      max_quote_per_leg: 0.0
      max_total_quote: 0.0

    profit_trail:
      p_min: 0.025
      s1: 0.01
      m_step: 1.6
      tau: 0.7
      p_lock_base: 0.007
      p_lock_max: 0.03
      tau_min: 0.3
      no_loss_epsilon: 0.0018

    time_martingale:
      W1_minutes: 5
      m_time: 2.0
      delta_lock: 0.002
      beta_tau: 0.9

    time_caps:
      T_idle_max_minutes: 70
      p_idle: 0.008
      T_total_cap_minutes: 180
      p_exit_min: 0.008

    features:
      scalp_mode:
        enabled: true
        # scalp_mode = เข้าเร็ว–ออกเร็ว แยกจากบันไดหลัก
        # max_trades = จำนวนไม้ scalp ต่อรอบ (ตั้ง 10 เพื่อเกิน 3 ไม้เดิม)
        max_trades: 10
        base_drop_pct: 0.03
        min_drop_pct: 0.015
        max_drop_pct: 0.06
        base_take_profit_pct: 0.01
        min_take_profit_pct: 0.008
        max_take_profit_pct: 0.02
        volatility_ref_pct: 0.04
        scale_strength: 0.6
        order_pct_allocation: 0.33
        cooldown_bars: 3
      micro_oscillation:
        enabled: true
        window: 45
        max_band_pct: 0.012
        min_swings: 5
        min_swing_pct: 0.0012
        entry_band_pct: 0.18
        take_profit_pct: 0.003
        stop_break_pct: 0.0035
        # Minimum margin above break-even (after fees) for micro exits
        min_profit_pct: 0.0025
        volatility_stop_mult: 1.0
        volatility_take_profit_mult: 0.7
        volatility_reentry_mult: 0.9
        order_pct_allocation: 0.12
        cooldown_bars: 8
        min_exit_qty: 0.0
      buy_the_dip:
        # เปิดซื้อดักหลุดบันได (dip) แยกจาก n_steps หลัก
        enabled: true
        dip_threshold: 0.05
        rebound_min: 0.004
        rebound_max: 0.02
        cooldown_minutes: 10
        max_orders: 7
        rebase_ladder_from_dip: true
        rebase_offset: 0.0
        order_quote: 0.0
        order_pct_remaining: 0.5
        limit_offset: 0.001
        cancel_on_miss: true
        isolate_from_ladder: true
      sell_at_height:
        # เปิดขายบนยอด (rip) เมื่อราคายืดเกิน threshold แล้วดึงกลับ
        enabled: true
        height_threshold: 0.04
        pullback_min: 0.004
        pullback_max: 0.02
        cooldown_minutes: 10
        order_pct_position: 0.5
        limit_offset: 0.001
        min_qty: 0.0
        cancel_on_miss: true
      adaptive_ladder:
        enabled: true
        bootstrap_d_buy: 0.03
        # จำกัดจำนวนขั้นช่วงสังเกตการณ์ก่อนคำนวณ d_buy ใหม่อัตโนมัติ
        bootstrap_steps: 3
        min_d_buy: 0.02
        max_d_buy: 0.08
        volatility_window: 120
        sensitivity: 0.6
        rebalance_threshold: 0.001
      anchor_drift:
        enabled: true
        structure_window: 40
        atr_period: 14
        breakout_atr_multiplier: 1.2
        stable_band_pct: 0.01
        dwell_bars: 15
        min_displacement_atr: 0.5
        min_displacement_pct: 0.005
        cooldown_bars: 20
    plotting: { enable: true }

  - symbol: BTCUSDT
    quote: USDT
    b_alloc: 7899.0
    source: binance
    interval: 1m
    lookback_days: 2
    fees: { taker: 0.001, maker: 0.001 }

    # บันไดสะสมหลัก (Martingale)
    # - d_buy: ระยะห่างแต่ละขั้น (เริ่ม 3%)
    # - m_buy: ตัวคูณขนาดไม้เมื่อถอยลง
    # - n_steps: จำนวนขั้นสูงสุดในรอบสะสมหลัก
    buy_ladder:
      d_buy: 0.02
      m_buy: 1.5
      n_steps: 10
      spacing_mode: fibo
      size_mode: fibonacci
      gap_mode: multiplicative
      gap_factor: 1.05
      max_step_drop: 0.3
      base_order_quote: 0.0
      max_quote_per_leg: 0.0
      max_total_quote: 0.0

    profit_trail:
      p_min: 0.025
      s1: 0.01
      m_step: 1.6
      tau: 0.7
      p_lock_base: 0.007
      p_lock_max: 0.03
      tau_min: 0.3
      no_loss_epsilon: 0.0018

    time_martingale:
      W1_minutes: 5
      m_time: 2.0
      delta_lock: 0.002
      beta_tau: 0.9

    time_caps:
      T_idle_max_minutes: 70
      p_idle: 0.008
      T_total_cap_minutes: 180
      p_exit_min: 0.008

    features:
      scalp_mode:
        enabled: true
        # scalp_mode = เข้าเร็ว–ออกเร็ว แยกจากบันไดหลัก
        # max_trades = จำนวนไม้ scalp ต่อรอบ (ตั้ง 10 เพื่อเกิน 3 ไม้เดิม)
        max_trades: 10
        base_drop_pct: 0.03
        min_drop_pct: 0.015
        max_drop_pct: 0.06
        base_take_profit_pct: 0.01
        min_take_profit_pct: 0.008
        max_take_profit_pct: 0.02
        volatility_ref_pct: 0.04
        scale_strength: 0.6
        order_pct_allocation: 0.33
        cooldown_bars: 3
      micro_oscillation:
        enabled: true
        window: 45
        max_band_pct: 0.012
        min_swings: 5
        min_swing_pct: 0.0012
        entry_band_pct: 0.18
        take_profit_pct: 0.003
        stop_break_pct: 0.0035
        # Minimum margin above break-even (after fees) for micro exits
        min_profit_pct: 0.0025
        volatility_stop_mult: 1.0
        volatility_take_profit_mult: 0.7
        volatility_reentry_mult: 0.9
        order_pct_allocation: 0.12
        cooldown_bars: 8
        min_exit_qty: 0.0
      buy_the_dip:
        # เปิดซื้อดักหลุดบันได (dip) แยกจาก n_steps หลัก
        enabled: true
        dip_threshold: 0.05
        rebound_min: 0.004
        rebound_max: 0.02
        cooldown_minutes: 10
        max_orders: 7
        rebase_ladder_from_dip: true
        rebase_offset: 0.0
        order_quote: 0.0
        order_pct_remaining: 0.5
        limit_offset: 0.001
        cancel_on_miss: true
        isolate_from_ladder: true
      sell_at_height:
        # เปิดขายบนยอด (rip) เมื่อราคายืดเกิน threshold แล้วดึงกลับ
        enabled: true
        height_threshold: 0.04
        pullback_min: 0.004
        pullback_max: 0.02
        cooldown_minutes: 10
        order_pct_position: 0.5
        limit_offset: 0.001
        min_qty: 0.0
        cancel_on_miss: true
      adaptive_ladder:
        enabled: true
        bootstrap_d_buy: 0.03
        # จำกัดจำนวนขั้นช่วงสังเกตการณ์ก่อนคำนวณ d_buy ใหม่อัตโนมัติ
        bootstrap_steps: 3
        min_d_buy: 0.02
        max_d_buy: 0.08
        volatility_window: 120
        sensitivity: 0.6
        rebalance_threshold: 0.001
      anchor_drift:
        enabled: true
        structure_window: 40
        atr_period: 14
        breakout_atr_multiplier: 1.2
        stable_band_pct: 0.01
        dwell_bars: 15
        min_displacement_atr: 0.5
        min_displacement_pct: 0.005
        cooldown_bars: 20
    plotting: { enable: true }

general:
  snapshot_every_bars: 1
  use_maker: true
  # จำกัดสลิปเพจก่อนยิงคำสั่ง EXIT (0 = ปิดการตรวจสอบ)
  max_exit_slippage_pct: 0.003
  sell_scale_out: { chunks: 1, delay_seconds: 1, profit_only: true }
  binance:
    base_url: "https://api.binance.com"
    retry: { attempts: 4, backoff_sec: 0.5 }
    save_csv: true
    data_dir: "data"
    # เปิดลดค่าธรรมเนียมเมื่อจ่ายด้วย BNB (0.75x ของ rate ปกติ). ปิดด้วย false หรือระบุ
    # ค่า multiplier เองผ่าน fee_discount_factor
    bnb_fee_discount: true
    # ใช้ค่าคูณ custom หากต้องการ เช่น 0.8 สำหรับส่วนลด 20%
    fee_discount_factor: 1.0
  profit_recycling:
    enabled: false
    # 1/10 ของกำไรแต่ละรอบจะถูกกันไว้ซื้อ coin price discount (ดีฟอลต์ = symbol ปัจจุบัน)
    discount_allocation_pct: 0.1
    # รวมกำไรทุกคู่แล้วแบ่ง 1/20 ไปซื้อ BNB ลด fee
    bnb_allocation_pct: 0.05
    min_order_quote: 10.0
    discount_symbol: ""
    bnb_symbol: BNBUSDT
    accumulation_filename: profit_accumulation.json
    rip_sell_fraction: 0.5